<html>
  <head>
    <script
      defer
      src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>
    <link
      href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css"
      rel="stylesheet"
    />
  </head>
  <body
    x-data="{
      sentenceI: 0,
      finSentences: [
        `Diego on muuttanut opiskelija-asuntoon Junatielle.`,
        `Asunto on soluasunto, jossa asuu Diegon lisäksi neljä muuta opiskelijaa.`,
      ],
      engSentences: [
        `Diego has moved into a student apartment on Junatie.`,
        `The apartment is a cell apartment where four other students live in addition to Diego.`,
      ],
      get blanks() {
        return this.finSentences[this.sentenceI].split(' ').map(word => '_____')
      },
      get words() {
        return this.finSentences[this.sentenceI].split(' ')
      },
      wordStatuses: [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false],
      blanksOn: true,
      hintsOn: false,
      get words2() {
        return this.words.map((word, index) => {
          return {
            text: word,
            id: index+1,
          }
        })
      },
      changeSentence: function(change) {
        if (change == 1 && this.sentenceI < this.finSentences.length - 1) {
          this.sentenceI++;
        } else if (change == -1 && this.sentenceI > 0) {
          this.sentenceI--;
        }
        this.resetWordStatuses();
      },
      resetWordStatuses: function() {
        for (let i = 0; i < this.words.length; i++) {
          this.wordStatuses[i] = false;
        }
      },
      showWords: function() {
        for (let i = 0; i < this.words.length; i++) {
          this.wordStatuses[i] = true;
        }
      },
      showBlanks: function() {
        this.blanksOn = true;
        this.hintsOn = false;
        this.resetWordStatuses();
      },
      showHints: function() {
        this.blanksOn = false;
        this.hintsOn = true;
        this.resetWordStatuses();
      },
    }"
    class="mx-6 my-16 flex justify-center text-3xl text-center"
  >
    <div>
      <p x-text="engSentences[sentenceI]" class="mb-6"></p>
      <div>
        <template x-for="(word, index) in words">
          <span @click="wordStatuses[index] = !wordStatuses[index]">
            <span
              x-show="!wordStatuses[index] && blanksOn"
              x-text="blanks[index]"
            ></span>
            <span
              x-show="!wordStatuses[index] && hintsOn"
              x-text="word[0] + '____'"
            ></span>
            <span
              x-show="wordStatuses[index] && (blanksOn || hintsOn)"
              x-text="word"
            ></span>
          </span>
        </template>
      </div>
      <div class="mt-16 text-lg">
        <button
          class="px-4 py-1 mx-2 border-2"
          @click="showBlanks();"
        >
          Blanks
        </button>
        <button
          class="px-4 py-1 mx-2 border-2"
          @click="showHints();"
        >
          Hints
        </button>
        <button
          class="px-4 py-1 mx-2 border-2"
          @click="showWords();"
        >
          Words
        </button>
      </div>
      <div class="m-8 text-lg">
        <button
          class="px-4 py-1 mx-2 border-2"
          @click="changeSentence(-1);"
        >
          Last sentence
        </button>
        <button
          class="px-4 py-1 mx-2 border-2"
          @click="changeSentence(1);"
        >
          Next sentence
        </button>
      </div>
    </div>
  </body>
</html>
